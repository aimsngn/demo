<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>6 or 7 Detector</title>
<style>
  :root { --page-bg:#ffffff; }
  *{box-sizing:border-box}
  html, body { height:100%; margin:0; background:var(--page-bg);
    display:grid; place-items:center;
    font-family:system-ui,-apple-system,Segoe UI,Roboto;
  }
  #centerImg{
    max-width:90vw; max-height:90vh;
    display:block; border:none;
  }
  /* Smaller camera preview */
  #video{
    position:fixed; top:16px; right:16px;
    width:120px; height:90px;           /* much smaller now */
    border:none; border-radius:8px;
    background:#000; object-fit:cover;
    box-shadow:0 0 8px rgba(0,0,0,0.25);
  }
  #startBtn{
    position:fixed; top:16px; left:16px;
    padding:.6rem 1rem; border:none; border-radius:8px;
    background:#001689; color:#fff; font-weight:600; cursor:pointer;
  }
</style>
</head>
<body>
  <img id="centerImg" alt="6â€“7" />
  <video id="video" playsinline muted autoplay></video>
  <button id="startBtn">Start</button>

  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js"></script>

  <script>
      const IMG_6 = "data:image/svg+xml;base64," + btoa(`
        <svg xmlns='http://www.w3.org/2000/svg' width='800' height='600'>
          <rect width='100%' height='100%' fill='#fff'/>
          <text x='50%' y='56%' font-size='300' font-weight='800'
                text-anchor='middle' fill='red'
                style='font-family:Arial, Helvetica, sans-serif'>6</text>
        </svg>
      `);
      
      const IMG_7 = "data:image/svg+xml;base64," + btoa(`
        <svg xmlns='http://www.w3.org/2000/svg' width='800' height='600'>
          <rect width='100%' height='100%' fill='#fff'/>
          <text x='50%' y='56%' font-size='300' font-weight='800'
                text-anchor='middle' fill='red'
                style='font-family:Arial, Helvetica, sans-serif'>7</text>
        </svg>
      `);


    const IMG_Q = "data:image/svg+xml;base64," + btoa(`
      <svg xmlns='http://www.w3.org/2000/svg' width='800' height='600'>
        <rect width='100%' height='100%' fill='#f4f6fb'/>
        <text x='50%' y='56%' font-size='300' font-weight='800' text-anchor='middle' fill='#9aa3b2'
          style='font-family:Arial, Helvetica, sans-serif'>?</text>
      </svg>`);

    const centerImg = document.getElementById('centerImg');
    const video = document.getElementById('video');
    const startBtn = document.getElementById('startBtn');
    centerImg.src = IMG_Q;

    video.muted = true;
    video.playsInline = true;

    async function startCamera() {
      try {
        const stream = await navigator.mediaDevices.getUserMedia({
          video: { facingMode: "user" }, audio: false
        });
        video.srcObject = stream;
        await video.play();
        startBtn.style.display = 'none';
        return true;
      } catch (e1) {
        try {
          const stream2 = await navigator.mediaDevices.getUserMedia({ video: true, audio: false });
          video.srcObject = stream2;
          await video.play();
          startBtn.style.display = 'none';
          return true;
        } catch (e2) {
          alert('Camera error: ' + (e2?.message || e2));
          return false;
        }
      }
    }

    const hands = new Hands({
      locateFile: (f) => `https://cdn.jsdelivr.net/npm/@mediapipe/hands/${f}`
    });
    hands.setOptions({
      selfieMode: true,
      maxNumHands: 2,
      minDetectionConfidence: 0.6,
      minTrackingConfidence: 0.6,
      modelComplexity: 1
    });

    function pickImage(results){
      const labels = (results.multiHandedness || []).map(h => h.label);
      const hasLeft = labels.includes("Left");
      const hasRight = labels.includes("Right");
      if (hasLeft && !hasRight) return IMG_6;
      if (!hasLeft && hasRight) return IMG_7;
      if (hasLeft && hasRight) return IMG_6;
      return IMG_Q;
    }

    hands.onResults((results) => { centerImg.src = pickImage(results); });

    async function init() {
      if (!navigator.mediaDevices?.getUserMedia) {
        alert("Camera not supported in this browser.");
        return;
      }
      const ok = await startCamera();
      if (!ok) return;
      const camera = new Camera(video, {
        onFrame: async () => { await hands.send({ image: video }); }
      });
      camera.start();
    }

    startBtn.addEventListener('click', init);
  </script>
</body>
</html>
